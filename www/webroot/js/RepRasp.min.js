/*! RepRasp https://www.huement.com/reprasp 2015-07-28 */
function startindex(){getstatus()}function startcontrols(){xyz_clicks(),mmspinner(),homerow_clicks(),$(".measured_amount .btn").on("click",function(a){a.preventDefault(),$(".measured_amount .btn").removeClass("active"),$(this).addClass("active")})}function mmspinner(){var a;$(".number-spinner button").mousedown(function(){btn=$(this),input=btn.closest(".number-spinner").find("input"),btn.closest(".number-spinner").find("button").prop("disabled",!1),a="up"==btn.attr("data-dir")?setInterval(function(){void 0==input.attr("max")||parseInt(input.val())<parseInt(input.attr("max"))?input.val(parseInt(input.val())+5):(btn.prop("disabled",!0),clearInterval(a))},50):setInterval(function(){void 0==input.attr("min")||parseInt(input.val())>parseInt(input.attr("min"))?input.val(parseInt(input.val())-5):(btn.prop("disabled",!0),clearInterval(a))},50)}).mouseup(function(){clearInterval(a)})}function homerow_clicks(){$(".home_x").on("click",function(a){a.preventDefault();var b={command:"home",axes:["x"]};homeaxis(b)}),$(".home_y").on("click",function(a){a.preventDefault();var b={command:"home",axes:["y"]};homeaxis(b)}),$(".home_z").on("click",function(a){a.preventDefault();var b={command:"home",axes:["z"]};homeaxis(b)})}function xyz_clicks(){$(".plus_x").on("click",function(a){a.preventDefault();var b=$(".measured_amount .active").data("amount"),c=parseInt(b,10);movedirection(c,0,0)}),$(".minus_x").on("click",function(a){a.preventDefault();var b=$(".measured_amount .active").data("amount"),c=parseInt("-"+b,10);movedirection(c,0,0)}),$(".plus_y").on("click",function(a){a.preventDefault();var b=$(".measured_amount .active").data("amount"),c=parseInt(b,10);movedirection(0,c,0)}),$(".minus_y").on("click",function(a){a.preventDefault();var b=$(".measured_amount .active").data("amount"),c=parseInt("-"+b,10);movedirection(0,c,0)}),$(".plus_z").on("click",function(a){a.preventDefault();var b=$(".measured_amount .active").data("amount"),c=parseInt(b,10);movedirection(0,0,c)}),$(".minus_z").on("click",function(a){a.preventDefault();var b=$(".measured_amount .active").data("amount"),c=parseInt("-"+b,10);movedirection(0,0,c)})}function movedirection(a,b,c){var d=GlobalURL+"/api/printer/printhead",e={command:"jog",x:a,y:b,z:c},f=JSON.stringify(e);$.ajax({type:"post",url:d,dataType:"json",data:f,contentType:"application/json",headers:{"X-Api-Key":GlobalKey},success:function(a){console.debug(a)},error:function(a){console.debug(a)}})}function homeaxis(a){var b=GlobalURL+"/api/printer/printhead",c=JSON.stringify(a);console.debug(a),$.ajax({type:"post",url:b,dataType:"json",data:c,contentType:"application/json",headers:{"X-Api-Key":GlobalKey},success:function(a){console.debug(a)},error:function(a){console.debug(a)}})}function getstatus(){var a=GlobalURL+"/api/connection";console.debug(a),$.ajax({type:"GET",url:a,dataType:"JSON",headers:{"X-Api-Key":GlobalKey},success:function(a){console.debug(a),void 0!==a.current&&void 0!==a.current.state&&($("#mac_state").text(a.current.state),"Operational"==a.current.state&&($(".status_panel").removeClass("panel-default").addClass("panel-success"),$(".status_lead ").addClass("alert-success")))},error:function(a){console.debug(a),$(".status_panel").removeClass("panel-default").addClass("panel-danger"),$(".status_lead ").addClass("alert-danger"),$("#mac_state").text("unreachable"),$("#printer_connect").html("<i class='fa fa-retweet'></i> Connect").removeClass("btn-danger").addClass("btn-default")}})}function start_page(){var a=$("#start_page").text();void 0!==a&&null!==a&&(console.debug("current page: "+a),"index"==a&&startindex(),"controls"==a&&startcontrols())}function configfile(){var a="webroot/files/defaults.json";$.ajax({type:"GET",url:a,dataType:"JSON",success:function(a){console.debug(a.apiurl),GlobalKey=a.apikey,GlobalURL="http://"+a.apiurl,GlobalDebug=a.debug,void 0!==a.apiurl&&""!==a.apiurl?(1==a.debug,start_page()):MumfordNote("Error. Config Not Found",!1,"error","true")},error:function(a){console.debug(a),$(".status_panel").removeClass("panel-default").addClass("panel-danger"),$(".status_lead ").addClass("alert-danger"),$("#mac_state").text("no config found")}})}var GlobalURL="octopi.local:5000",GlobalKey="",GlobalDebug=0;$(document).ready(function(){configfile()});